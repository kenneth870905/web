(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f37bc792"],{"159b":function(e,t,r){var a=r("da84"),i=r("fdbc"),o=r("17c2"),n=r("9112");for(var s in i){var l=a[s],c=l&&l.prototype;if(c&&c.forEach!==o)try{n(c,"forEach",o)}catch(u){c.forEach=o}}},"17c2":function(e,t,r){"use strict";var a=r("b727").forEach,i=r("a640"),o=r("ae40"),n=i("forEach"),s=o("forEach");e.exports=n&&s?[].forEach:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}},"1a23":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{ref:"锚点"},[r("el-page-header",{attrs:{content:e.sp.id?"编辑商品":"添加商品"},on:{back:e.goBack}})],1),r("div",{staticClass:"form"},[r("el-form",{ref:"spFrom",attrs:{model:e.sp,rules:e.spRules,size:"small","label-width":"80px"},nativeOn:{submit:function(e){e.preventDefault()}}},[r("el-form-item",{attrs:{label:"商品分类",prop:"categoryId"}},[r("el-select",{model:{value:e.sp.categoryId,callback:function(t){e.$set(e.sp,"categoryId",t)},expression:"sp.categoryId"}},[e.sp.categoryId?e._e():r("el-option",{attrs:{label:"请选择分类",value:0}}),e._l(e.分类,(function(e,t){return r("el-option",{attrs:{label:e.name,value:e.id}})}))],2)],1),r("el-form-item",{attrs:{label:"放置首页"}},[r("el-select",{model:{value:e.sp.isHomePage,callback:function(t){e.$set(e.sp,"isHomePage",t)},expression:"sp.isHomePage"}},[r("el-option",{attrs:{label:"否",value:!1}}),r("el-option",{attrs:{label:"是",value:!0}})],1)],1),r("el-form-item",{attrs:{label:"是否推荐"}},[r("el-select",{model:{value:e.sp.isRecommend,callback:function(t){e.$set(e.sp,"isRecommend",t)},expression:"sp.isRecommend"}},[r("el-option",{attrs:{label:"否",value:!1}}),r("el-option",{attrs:{label:"是",value:!0}})],1)],1),r("el-form-item",{attrs:{label:"商品名称",prop:"name"}},[r("el-input",{attrs:{placeholder:"请输入商品名称"},model:{value:e.sp.name,callback:function(t){e.$set(e.sp,"name",t)},expression:"sp.name"}})],1),r("el-form-item",{attrs:{label:"商品标题"}},[r("el-input",{attrs:{placeholder:"放置首页商品请输入标题，其他可忽略"},model:{value:e.sp.title,callback:function(t){e.$set(e.sp,"title",t)},expression:"sp.title"}})],1),r("el-form-item",{attrs:{label:"商品简介"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.sp.brief,callback:function(t){e.$set(e.sp,"brief",t)},expression:"sp.brief"}})],1),r("el-form-item",{attrs:{label:"购买级别"}},[r("el-select",{model:{value:e.sp.level,callback:function(t){e.$set(e.sp,"level",t)},expression:"sp.level"}},[r("el-option",{key:0,attrs:{label:"允许所有用户购买",value:0}}),r("el-option",{key:1,attrs:{label:"一级和二级用户都可以购买",value:1}}),r("el-option",{key:2,attrs:{label:"只有二级用户才可以购买",value:2}})],1)],1),r("el-form-item",{attrs:{label:"一级价格",prop:"levelOnePrice"}},[r("el-input",{attrs:{type:"number",step:"0.01",placeholder:"请输入一级价格"},on:{change:function(t){return e.change_1("levelOnePrice")}},model:{value:e.sp.levelOnePrice,callback:function(t){e.$set(e.sp,"levelOnePrice",t)},expression:"sp.levelOnePrice"}})],1),r("el-form-item",{attrs:{label:"二级价格",prop:"levelTwoPrice"}},[r("el-input",{attrs:{type:"number",step:"0.01",placeholder:"请输入二级价格"},on:{change:function(t){return e.change_1("levelTwoPrice")}},model:{value:e.sp.levelTwoPrice,callback:function(t){e.$set(e.sp,"levelTwoPrice",t)},expression:"sp.levelTwoPrice"}})],1),r("el-form-item",{attrs:{label:"积分价格",prop:"creditPrice"}},[r("el-input",{attrs:{type:"number",step:"0.01",placeholder:"请输入积分价格"},on:{change:function(t){return e.change_1("creditPrice")}},model:{value:e.sp.creditPrice,callback:function(t){e.$set(e.sp,"creditPrice",t)},expression:"sp.creditPrice"}})],1),r("el-form-item",{attrs:{label:"限购数量"}},[r("el-input",{attrs:{type:"number",step:"0.01",placeholder:"限购数量：0 表示不限购"},model:{value:e.sp.maxPurchaseCount,callback:function(t){e.$set(e.sp,"maxPurchaseCount",t)},expression:"sp.maxPurchaseCount"}})],1),r("el-form-item",{attrs:{label:"是否返佣"}},[r("el-radio-group",{model:{value:e.sp.isKickback,callback:function(t){e.$set(e.sp,"isKickback",t)},expression:"sp.isKickback"}},[r("el-radio",{attrs:{label:!0}},[e._v("返佣")]),r("el-radio",{attrs:{label:!1}},[e._v("不返佣")])],1)],1),e.sp.isKickback?r("el-form-item",{attrs:{label:"返佣比例",prop:"kickbackRate"}},[r("el-input",{attrs:{type:"number",step:"0.01",placeholder:"请输入返佣比例"},on:{change:function(t){return e.change_1("kickbackRate")}},model:{value:e.sp.kickbackRate,callback:function(t){e.$set(e.sp,"kickbackRate",t)},expression:"sp.kickbackRate"}})],1):e._e(),r("el-form-item",{attrs:{label:"封面图片"}},[r("div",{staticClass:"封面",on:{click:function(t){return e.changeFile(1)}}},[e.sp.coverImg||e.coverImgFile.base64?e._e():r("i",{staticClass:"el-icon-plus"}),e.coverImgFile.base64?r("img",{attrs:{src:e.coverImgFile.base64,alt:"",srcset:""}}):e._e(),e.sp.coverImg&&!e.coverImgFile.base64?r("img",{attrs:{src:e.$api_url+"/"+e.sp.coverImg,alt:""}}):e._e()])]),r("el-form-item",{attrs:{label:"轮播图片"}},[r("ul",{staticClass:"轮播图"},[e._l(e.sp.imgs,(function(t,a){return r("li",[r("img",{attrs:{src:e.$api_url+"/"+t,alt:"",srcset:""}}),r("i",{staticClass:"el-icon-delete",on:{click:function(t){return e.sp.imgs.splice(a,1)}}})])})),e._l(e.imgsFiles,(function(t,a){return r("li",[r("img",{attrs:{src:t.base64,alt:"",srcset:""}}),r("i",{staticClass:"el-icon-delete",on:{click:function(t){return e.imgsFiles.splice(a,1)}}})])})),r("li",{on:{click:function(t){return e.changeFile(2)}}},[r("i",{staticClass:"el-icon-plus"})])],2)]),r("el-form-item",{attrs:{label:"图文介绍"}},[r("div",{staticClass:"编辑器"},[r("quill-editor",{ref:"myQuillEditor",staticClass:"editor",attrs:{options:e.editorOption},model:{value:e.sp.description,callback:function(t){e.$set(e.sp,"description",t)},expression:"sp.description"}})],1)]),r("div",[r("el-button",{staticClass:"btn_1",attrs:{"native-type":"submit",type:"warning"},on:{click:function(t){return e.onSubmit()}}},[e._v("保存")])],1)],1)],1),e.showFile?r("input",{ref:"file1",staticClass:"fileInput",attrs:{type:"file",accept:"image/*"},on:{change:e.fileChange}}):e._e()])},i=[],o=(r("99af"),r("4160"),r("a9e3"),r("8ba4"),r("d3b7"),r("3ca3"),r("159b"),r("ddb0"),r("2909")),n=(r("96cf"),r("1da1")),s=r("953d"),l=(r("a753"),r("8096"),r("14e1"),{name:"",components:{quillEditor:s["quillEditor"]},data:function(){var e=this;return{sp:{id:"",name:"",level:0,levelOnePrice:"",levelTwoPrice:"",creditPrice:"",isKickback:!0,kickbackRate:0,maxPurchaseCount:0,imgs:[],coverImg:"",description:"",categoryId:"",isHomePage:!1,isRecommend:!1,brief:""},spRules:{categoryId:[{required:!0,trigger:"blur",validator:function(e,t,r){t?r():r(new Error("请选择分类"))}}],name:[{required:!0,message:"请输入商品名称",trigger:"blur"}],levelOnePrice:[{trigger:"blur",required:!0,validator:function(e,t,r){""===t?r(new Error("请输入一级价格")):t<=0?r(new Error("价格必须大于0")):r()}}],levelTwoPrice:[{required:!0,trigger:"blur",validator:function(e,t,r){""===t?r(new Error("请输入二级价格")):t<=0?r(new Error("价格必须大于0")):r()}}],creditPrice:[{trigger:"blur",validator:function(e,t,r){Number.isInteger(t)?r():r(new Error("积分价格必须是整数"))}}],kickbackRate:[{trigger:"blur",validator:function(e,t,r){t<0||t>1?r(new Error("返佣范围在0-1之间如：0.5")):r()}}]},coverImgFile:{base64:"",file:""},imgsFiles:[],showFile:!1,file_type:1,editorOption:{placeholder:"请输入内容",modules:{toolbar:{container:[["bold","italic","underline","strike"],[{header:1},{header:2}],[{color:[]},{background:[]}],["image"]],handlers:{image:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r?e.changeFile(3):console.log(!1);case 1:case"end":return t.stop()}}),t)})));function r(e){return t.apply(this,arguments)}return r}()}}}},"分类":[]}},computed:{},methods:{goBack:function(){history.back()},fileChange:function(e){var t=this,r=e.target.files[0];if(1==this.file_type){var a=new FileReader;return a.readAsDataURL(r),a.onload=function(e){console.log(e),t.coverImgFile.base64=e.target.result},void(this.coverImgFile.file=r)}if(2==this.file_type){a=new FileReader;return a.readAsDataURL(r),void(a.onload=function(e){var a={base64:e.target.result,file:r};t.imgsFiles.push(a)})}this.$loading(1);var i=new FormData;i.append("file",r),this.$axios({method:"post",url:this.$api_url+"/api/upload",data:i}).then((function(e){if(console.log(e),e.data&&e.data.length>0){var r=t.$refs.myQuillEditor.quill,a=r.getSelection().index;r.insertEmbed(a,"image",t.$api_url+"/"+e.data[0]),r.setSelection(a+1)}else t.$message({showClose:!0,message:"图片上传失败",type:"error"});t.$loading(0)})).catch((function(e){t.$message({showClose:!0,message:"图片上传失败",type:"error"}),t.$loading(0)}))},changeFile:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.file_type=e,t.showFile=!1,r.next=4,t.$nextTick();case 4:t.showFile=!0,t.$nextTick((function(){t.$refs.file1.click()}));case 6:case"end":return r.stop()}}),r)})))()},onSubmit:function(){var e=this;this.$refs.spFrom.validate((function(t){if(!t)return console.log(t),e.$message({showClose:!0,message:"内容填写有误",type:"error"}),e.$refs.锚点.scrollIntoView({behavior:"smooth"}),!1;e.sp.id?e.修改():e.add()}))},upload1:function(){var e=this;return new Promise((function(t,r){if(e.coverImgFile.file){var a=new FormData;a.append("file",e.coverImgFile.file),e.$axios.post("/api/upload",a).then((function(r){console.log(r),r.data&&r.data.length>0&&(e.coverImgFile={base64:"",file:""},e.sp.coverImg=r.data[0]),t()})).catch((function(e){t()}))}else t()}))},upload2:function(){var e=this;return new Promise((function(t,r){if(0==e.imgsFiles.length)t();else{var a=new FormData;e.imgsFiles.forEach((function(e){a.append("file",e.file)})),e.$axios.post("/api/upload",a).then((function(r){console.log(r),r.data&&r.data.length>0&&(e.imgsFiles=[],e.sp.imgs=[].concat(Object(o["a"])(e.sp.imgs),Object(o["a"])(r.data))),t()})).catch((function(e){t()}))}}))},add:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$loading(1),Promise.all([e.upload1(),e.upload2()]).then((function(t){e.$axios.post("/api/product",e.sp).then((function(t){console.log(t),0==t.code?(e.$message({showClose:!0,message:"添加成功",type:"success"}),history.back()):e.$message({showClose:!0,message:"添加失败，请联系管理员",type:"error"}),e.$loading()})).catch((function(t){e.$message({showClose:!0,message:"添加失败，请联系管理员",type:"error"}),e.$loading(0)}))}));case 2:case"end":return t.stop()}}),t)})))()},"修改":function(){var e=this;this.$loading(1),Promise.all([this.upload1(),this.upload2()]).then((function(t){delete e.sp.createdAt,delete e.sp.updatedAt,delete e.sp.deletedAt,e.$axios.put("/api/product/".concat(e.sp.id),e.sp).then((function(t){console.log(t),0==t.code?(e.$message({showClose:!0,message:"更新成功",type:"success"}),history.back()):e.$message({showClose:!0,message:"更新失败，请联系管理员",type:"error"}),e.$loading()})).catch((function(t){e.$message({showClose:!0,message:"更新失败，请联系管理员",type:"error"}),e.$loading(0)}))}))},getproduct:function(){var e=this;this.$axios.get("/api/product/".concat(this.sp.id)).then((function(t){0==t.code&&(e.sp=t.data)})).catch((function(e){}))},change_1:function(e){this.sp[e]=this.sp[e]?Math.ceil(100*this.sp[e])/100:0},"获取商品分类":function(){var e=this;this.$axios.get("/api/category",{params:{page:1,size:1e3}}).then((function(t){0===t.code&&(e.分类=t.data,!e.sp.id&&e.分类.length>0&&(e.sp.categoryId=e.分类[0].id))}))}},mounted:function(){this.获取商品分类(),this.sp.id=this.$route.query.id,this.sp.id&&this.getproduct()},watch:{}}),c=l,u=(r("58f4"),r("2877")),p=Object(u["a"])(c,a,i,!1,null,"31b11d00",null);t["default"]=p.exports},2909:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var a=r("6b75");function i(e){if(Array.isArray(e))return Object(a["a"])(e)}r("a4d3"),r("e01a"),r("d28b"),r("a630"),r("d3b7"),r("3ca3"),r("ddb0");function o(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}var n=r("06c5");function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e){return i(e)||o(e)||Object(n["a"])(e)||s()}},4160:function(e,t,r){"use strict";var a=r("23e7"),i=r("17c2");a({target:"Array",proto:!0,forced:[].forEach!=i},{forEach:i})},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,r){var a=r("1d80"),i=r("5899"),o="["+i+"]",n=RegExp("^"+o+o+"*"),s=RegExp(o+o+"*$"),l=function(e){return function(t){var r=String(a(t));return 1&e&&(r=r.replace(n,"")),2&e&&(r=r.replace(s,"")),r}};e.exports={start:l(1),end:l(2),trim:l(3)}},"58f4":function(e,t,r){"use strict";r("6131")},"5e89":function(e,t,r){var a=r("861d"),i=Math.floor;e.exports=function(e){return!a(e)&&isFinite(e)&&i(e)===e}},6131:function(e,t,r){var a=r("c245");"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var i=r("499e").default;i("77f97cc8",a,!0,{sourceMap:!1,shadowMode:!1})},7156:function(e,t,r){var a=r("861d"),i=r("d2bb");e.exports=function(e,t,r){var o,n;return i&&"function"==typeof(o=t.constructor)&&o!==r&&a(n=o.prototype)&&n!==r.prototype&&i(e,n),e}},"8ba4":function(e,t,r){var a=r("23e7"),i=r("5e89");a({target:"Number",stat:!0},{isInteger:i})},"99af":function(e,t,r){"use strict";var a=r("23e7"),i=r("d039"),o=r("e8b5"),n=r("861d"),s=r("7b0b"),l=r("50c4"),c=r("8418"),u=r("65f0"),p=r("1dde"),d=r("b622"),f=r("2d00"),m=d("isConcatSpreadable"),b=9007199254740991,h="Maximum allowed index exceeded",g=f>=51||!i((function(){var e=[];return e[m]=!1,e.concat()[0]!==e})),v=p("concat"),x=function(e){if(!n(e))return!1;var t=e[m];return void 0!==t?!!t:o(e)},k=!g||!v;a({target:"Array",proto:!0,forced:k},{concat:function(e){var t,r,a,i,o,n=s(this),p=u(n,0),d=0;for(t=-1,a=arguments.length;t<a;t++)if(o=-1===t?n:arguments[t],x(o)){if(i=l(o.length),d+i>b)throw TypeError(h);for(r=0;r<i;r++,d++)r in o&&c(p,d,o[r])}else{if(d>=b)throw TypeError(h);c(p,d++,o)}return p.length=d,p}})},a640:function(e,t,r){"use strict";var a=r("d039");e.exports=function(e,t){var r=[][e];return!!r&&a((function(){r.call(null,t||function(){throw 1},1)}))}},a9e3:function(e,t,r){"use strict";var a=r("83ab"),i=r("da84"),o=r("94ca"),n=r("6eeb"),s=r("5135"),l=r("c6b6"),c=r("7156"),u=r("c04e"),p=r("d039"),d=r("7c73"),f=r("241c").f,m=r("06cf").f,b=r("9bf2").f,h=r("58a8").trim,g="Number",v=i[g],x=v.prototype,k=l(d(x))==g,w=function(e){var t,r,a,i,o,n,s,l,c=u(e,!1);if("string"==typeof c&&c.length>2)if(c=h(c),t=c.charCodeAt(0),43===t||45===t){if(r=c.charCodeAt(2),88===r||120===r)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:a=2,i=49;break;case 79:case 111:a=8,i=55;break;default:return+c}for(o=c.slice(2),n=o.length,s=0;s<n;s++)if(l=o.charCodeAt(s),l<48||l>i)return NaN;return parseInt(o,a)}return+c};if(o(g,!v(" 0o1")||!v("0b1")||v("+0x1"))){for(var y,$=function(e){var t=arguments.length<1?0:e,r=this;return r instanceof $&&(k?p((function(){x.valueOf.call(r)})):l(r)!=g)?c(new v(w(t)),r,$):w(t)},I=a?f(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),E=0;I.length>E;E++)s(v,y=I[E])&&!s($,y)&&b($,y,m(v,y));$.prototype=x,x.constructor=$,n(i,g,$)}},c245:function(e,t,r){var a=r("24fb");t=a(!1),t.push([e.i,"[data-v-31b11d00] .ql-container{min-height:300px}.fileInput[data-v-31b11d00]{display:none}.编辑器[data-v-31b11d00]{width:400px}.btn_1[data-v-31b11d00]{width:100%}.el-page-header[data-v-31b11d00]{border-bottom:1px solid #bfbfbf;padding-bottom:15px}.form[data-v-31b11d00]{padding:20px 0 0}.封面[data-v-31b11d00]{width:180px;height:180px;border:1px dashed #d9d9d9;cursor:pointer;display:flex;align-items:center;justify-content:center}.封面 i[data-v-31b11d00]{font-size:28px}.封面[data-v-31b11d00]:hover{border:1px dashed #409eff}.封面 img[data-v-31b11d00]{width:100%;height:100%;-o-object-fit:contain;object-fit:contain}.轮播图[data-v-31b11d00]{padding:20px;border:1px solid #ebebeb;border-radius:3px;display:flex;flex-wrap:wrap}.轮播图 li[data-v-31b11d00]{width:180px;height:180px;margin:5px;border:1px dashed #d9d9d9;position:relative}.轮播图 li img[data-v-31b11d00]{width:100%;height:100%;-o-object-fit:contain;object-fit:contain}.轮播图 li i[data-v-31b11d00]{position:absolute}.轮播图 li .el-icon-delete[data-v-31b11d00]{top:0;right:0;font-size:25px;color:red;cursor:pointer}.轮播图 li .el-icon-plus[data-v-31b11d00]{top:0;left:0;bottom:0;right:0;margin:auto;width:28px;height:28px;font-size:28px}.轮播图 li[data-v-31b11d00]:last-child{cursor:pointer}.轮播图 li[data-v-31b11d00]:last-child:hover{border:1px dashed #409eff}",""]),e.exports=t}}]);
//# sourceMappingURL=chunk-f37bc792.e922c8ef.js.map