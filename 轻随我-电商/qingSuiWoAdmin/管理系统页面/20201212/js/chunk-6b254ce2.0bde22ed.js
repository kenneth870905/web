(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6b254ce2"],{"10d0":function(e,t,a){var r=a("dc8b");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=a("499e").default;i("e6d32bb2",r,!0,{sourceMap:!1,shadowMode:!1})},"159b":function(e,t,a){var r=a("da84"),i=a("fdbc"),n=a("17c2"),o=a("9112");for(var s in i){var c=r[s],l=c&&c.prototype;if(l&&l.forEach!==n)try{o(l,"forEach",n)}catch(u){l.forEach=n}}},"17c2":function(e,t,a){"use strict";var r=a("b727").forEach,i=a("a640"),n=a("ae40"),o=i("forEach"),s=n("forEach");e.exports=o&&s?[].forEach:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}},2909:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var r=a("6b75");function i(e){if(Array.isArray(e))return Object(r["a"])(e)}a("a4d3"),a("e01a"),a("d28b"),a("a630"),a("d3b7"),a("3ca3"),a("ddb0");function n(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}var o=a("06c5");function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e){return i(e)||n(e)||Object(o["a"])(e)||s()}},4160:function(e,t,a){"use strict";var r=a("23e7"),i=a("17c2");r({target:"Array",proto:!0,forced:[].forEach!=i},{forEach:i})},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,a){var r=a("1d80"),i=a("5899"),n="["+i+"]",o=RegExp("^"+n+n+"*"),s=RegExp(n+n+"*$"),c=function(e){return function(t){var a=String(r(t));return 1&e&&(a=a.replace(o,"")),2&e&&(a=a.replace(s,"")),a}};e.exports={start:c(1),end:c(2),trim:c(3)}},"5e89":function(e,t,a){var r=a("861d"),i=Math.floor;e.exports=function(e){return!r(e)&&isFinite(e)&&i(e)===e}},7156:function(e,t,a){var r=a("861d"),i=a("d2bb");e.exports=function(e,t,a){var n,o;return i&&"function"==typeof(n=t.constructor)&&n!==a&&r(o=n.prototype)&&o!==a.prototype&&i(e,o),e}},"8ba4":function(e,t,a){var r=a("23e7"),i=a("5e89");r({target:"Number",stat:!0},{isInteger:i})},"99af":function(e,t,a){"use strict";var r=a("23e7"),i=a("d039"),n=a("e8b5"),o=a("861d"),s=a("7b0b"),c=a("50c4"),l=a("8418"),u=a("65f0"),f=a("1dde"),d=a("b622"),p=a("2d00"),h=d("isConcatSpreadable"),g=9007199254740991,m="Maximum allowed index exceeded",b=p>=51||!i((function(){var e=[];return e[h]=!1,e.concat()[0]!==e})),v=f("concat"),k=function(e){if(!o(e))return!1;var t=e[h];return void 0!==t?!!t:n(e)},w=!b||!v;r({target:"Array",proto:!0,forced:w},{concat:function(e){var t,a,r,i,n,o=s(this),f=u(o,0),d=0;for(t=-1,r=arguments.length;t<r;t++)if(n=-1===t?o:arguments[t],k(n)){if(i=c(n.length),d+i>g)throw TypeError(m);for(a=0;a<i;a++,d++)a in n&&l(f,d,n[a])}else{if(d>=g)throw TypeError(m);l(f,d++,n)}return f.length=d,f}})},a640:function(e,t,a){"use strict";var r=a("d039");e.exports=function(e,t){var a=[][e];return!!a&&r((function(){a.call(null,t||function(){throw 1},1)}))}},a9e3:function(e,t,a){"use strict";var r=a("83ab"),i=a("da84"),n=a("94ca"),o=a("6eeb"),s=a("5135"),c=a("c6b6"),l=a("7156"),u=a("c04e"),f=a("d039"),d=a("7c73"),p=a("241c").f,h=a("06cf").f,g=a("9bf2").f,m=a("58a8").trim,b="Number",v=i[b],k=v.prototype,w=c(d(k))==b,x=function(e){var t,a,r,i,n,o,s,c,l=u(e,!1);if("string"==typeof l&&l.length>2)if(l=m(l),t=l.charCodeAt(0),43===t||45===t){if(a=l.charCodeAt(2),88===a||120===a)return NaN}else if(48===t){switch(l.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+l}for(n=l.slice(2),o=n.length,s=0;s<o;s++)if(c=n.charCodeAt(s),c<48||c>i)return NaN;return parseInt(n,r)}return+l};if(n(b,!v(" 0o1")||!v("0b1")||v("+0x1"))){for(var y,I=function(e){var t=arguments.length<1?0:e,a=this;return a instanceof I&&(w?f((function(){k.valueOf.call(a)})):c(a)!=b)?l(new v(x(t)),a,I):x(t)},$=r?p(v):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),E=0;$.length>E;E++)s(v,y=$[E])&&!s(I,y)&&g(I,y,h(v,y));I.prototype=k,k.constructor=I,o(i,b,I)}},dc8b:function(e,t,a){var r=a("24fb");t=r(!1),t.push([e.i,"[data-v-f17f895a] .ql-container{min-height:300px}.fileInput[data-v-f17f895a]{display:none}.编辑器[data-v-f17f895a]{width:400px}.btn_1[data-v-f17f895a]{width:100%}.el-page-header[data-v-f17f895a]{border-bottom:1px solid #bfbfbf;padding-bottom:15px}.form[data-v-f17f895a]{padding:20px 0 0}.封面[data-v-f17f895a]{width:180px;height:180px;border:1px dashed #d9d9d9;cursor:pointer;display:flex;align-items:center;justify-content:center}.封面 i[data-v-f17f895a]{font-size:28px}.封面[data-v-f17f895a]:hover{border:1px dashed #409eff}.封面 img[data-v-f17f895a]{width:100%;height:100%;-o-object-fit:contain;object-fit:contain}.轮播图[data-v-f17f895a]{padding:20px;border:1px solid #ebebeb;border-radius:3px;display:flex;flex-wrap:wrap}.轮播图 li[data-v-f17f895a]{width:180px;height:180px;margin:5px;border:1px dashed #d9d9d9;position:relative}.轮播图 li img[data-v-f17f895a]{width:100%;height:100%;-o-object-fit:contain;object-fit:contain}.轮播图 li i[data-v-f17f895a]{position:absolute}.轮播图 li .el-icon-delete[data-v-f17f895a]{top:0;right:0;font-size:25px;color:red;cursor:pointer}.轮播图 li .el-icon-plus[data-v-f17f895a]{top:0;left:0;bottom:0;right:0;margin:auto;width:28px;height:28px;font-size:28px}.轮播图 li[data-v-f17f895a]:last-child{cursor:pointer}.轮播图 li[data-v-f17f895a]:last-child:hover{border:1px dashed #409eff}",""]),e.exports=t},e19d:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{ref:"锚点"},[a("el-page-header",{attrs:{content:e.sp.id?"编辑秒杀商品":"添加秒杀商品"},on:{back:e.goBack}})],1),a("div",{staticClass:"form"},[a("el-form",{ref:"spFrom",attrs:{model:e.sp,rules:e.spRules,size:"small","label-width":"80px"},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:"商品名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入商品名称"},model:{value:e.sp.name,callback:function(t){e.$set(e.sp,"name",t)},expression:"sp.name"}})],1),a("el-form-item",{attrs:{label:"秒杀价格"}},[a("el-input",{attrs:{type:"number",step:"0.01",placeholder:"请输入秒杀价格"},on:{change:function(t){return e.change_1("seckillPrice")}},model:{value:e.sp.seckillPrice,callback:function(t){e.$set(e.sp,"seckillPrice",t)},expression:"sp.seckillPrice"}})],1),a("el-form-item",{attrs:{label:"限购数量"}},[a("el-input",{attrs:{type:"number",step:"0.01",placeholder:"限购数量：0 表示不限购"},model:{value:e.sp.maxPurchaseCount,callback:function(t){e.$set(e.sp,"maxPurchaseCount",t)},expression:"sp.maxPurchaseCount"}})],1),a("el-form-item",{attrs:{label:"是否返佣"}},[a("el-radio-group",{model:{value:e.sp.isKickback,callback:function(t){e.$set(e.sp,"isKickback",t)},expression:"sp.isKickback"}},[a("el-radio",{attrs:{label:!0}},[e._v("返佣")]),a("el-radio",{attrs:{label:!1}},[e._v("不返佣")])],1)],1),e.sp.isKickback?a("el-form-item",{attrs:{label:"返佣比例",prop:"kickbackRate"}},[a("el-input",{attrs:{type:"number",step:"0.01",placeholder:"请输入返佣比例"},on:{change:function(t){return e.change_1("kickbackRate")}},model:{value:e.sp.kickbackRate,callback:function(t){e.$set(e.sp,"kickbackRate",t)},expression:"sp.kickbackRate"}})],1):e._e(),a("el-form-item",{attrs:{label:"封面图片"}},[a("div",{staticClass:"封面",on:{click:function(t){return e.changeFile(1)}}},[e.sp.coverImg||e.coverImgFile.base64?e._e():a("i",{staticClass:"el-icon-plus"}),e.coverImgFile.base64?a("img",{attrs:{src:e.coverImgFile.base64,alt:"",srcset:""}}):e._e(),e.sp.coverImg&&!e.coverImgFile.base64?a("img",{attrs:{src:e.$api_url+"/"+e.sp.coverImg,alt:""}}):e._e()])]),a("el-form-item",{attrs:{label:"轮播图片"}},[a("ul",{staticClass:"轮播图"},[e._l(e.sp.imgs,(function(t,r){return a("li",[a("img",{attrs:{src:e.$api_url+"/"+t,alt:"",srcset:""}}),a("i",{staticClass:"el-icon-delete",on:{click:function(t){return e.sp.imgs.splice(r,1)}}})])})),e._l(e.imgsFiles,(function(t,r){return a("li",[a("img",{attrs:{src:t.base64,alt:"",srcset:""}}),a("i",{staticClass:"el-icon-delete",on:{click:function(t){return e.imgsFiles.splice(r,1)}}})])})),a("li",{on:{click:function(t){return e.changeFile(2)}}},[a("i",{staticClass:"el-icon-plus"})])],2)]),a("el-form-item",{attrs:{label:"图文介绍"}},[a("div",{staticClass:"编辑器"},[a("quill-editor",{ref:"myQuillEditor",staticClass:"editor",attrs:{options:e.editorOption},model:{value:e.sp.description,callback:function(t){e.$set(e.sp,"description",t)},expression:"sp.description"}})],1)]),a("div",[a("el-button",{staticClass:"btn_1",attrs:{"native-type":"submit",type:"warning"},on:{click:function(t){return e.onSubmit()}}},[e._v("保存")])],1)],1)],1),e.showFile?a("input",{ref:"file1",staticClass:"fileInput",attrs:{type:"file",accept:"image/*"},on:{change:e.fileChange}}):e._e()])},i=[],n=(a("99af"),a("4160"),a("a9e3"),a("8ba4"),a("d3b7"),a("3ca3"),a("159b"),a("ddb0"),a("2909")),o=(a("96cf"),a("1da1")),s=a("953d"),c=(a("a753"),a("8096"),a("14e1"),{name:"",components:{quillEditor:s["quillEditor"]},data:function(){var e=this;return{sp:{id:"",name:"",level:0,levelOnePrice:0,levelTwoPrice:0,creditPrice:0,isKickback:!0,kickbackRate:0,maxPurchaseCount:0,imgs:[],coverImg:"",description:"",categoryId:0,isHomePage:!1,isRecommend:!1,brief:"",seckillPrice:0,isSeckill:!0},spRules:{categoryId:[{required:!0,trigger:"blur",validator:function(e,t,a){t?a():a(new Error("请选择分类"))}}],name:[{required:!0,message:"请输入商品名称",trigger:"blur"}],levelOnePrice:[{trigger:"blur",required:!0,validator:function(e,t,a){""===t?a(new Error("请输入一级价格")):t<=0?a(new Error("价格必须大于0")):a()}}],levelTwoPrice:[{required:!0,trigger:"blur",validator:function(e,t,a){""===t?a(new Error("请输入二级价格")):t<=0?a(new Error("价格必须大于0")):a()}}],creditPrice:[{trigger:"blur",validator:function(e,t,a){Number.isInteger(t)?a():a(new Error("积分价格必须是整数"))}}],kickbackRate:[{trigger:"blur",validator:function(e,t,a){t<0||t>1?a(new Error("返佣范围在0-1之间如：0.5")):a()}}]},coverImgFile:{base64:"",file:""},imgsFiles:[],showFile:!1,file_type:1,editorOption:{placeholder:"请输入内容",modules:{toolbar:{container:[["bold","italic","underline","strike"],[{header:1},{header:2}],[{color:[]},{background:[]}],["image"]],handlers:{image:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a?e.changeFile(3):console.log(!1);case 1:case"end":return t.stop()}}),t)})));function a(e){return t.apply(this,arguments)}return a}()}}}},"分类":[]}},computed:{},methods:{goBack:function(){history.back()},fileChange:function(e){var t=this,a=e.target.files[0];if(1==this.file_type){var r=new FileReader;return r.readAsDataURL(a),r.onload=function(e){console.log(e),t.coverImgFile.base64=e.target.result},void(this.coverImgFile.file=a)}if(2==this.file_type){r=new FileReader;return r.readAsDataURL(a),void(r.onload=function(e){var r={base64:e.target.result,file:a};t.imgsFiles.push(r)})}this.$loading(1);var i=new FormData;i.append("file",a),this.$axios({method:"post",url:this.$api_url+"/api/upload",data:i}).then((function(e){if(console.log(e),e.data&&e.data.length>0){var a=t.$refs.myQuillEditor.quill,r=a.getSelection().index;a.insertEmbed(r,"image",t.$api_url+"/"+e.data[0]),a.setSelection(r+1)}else t.$message({showClose:!0,message:"图片上传失败",type:"error"});t.$loading(0)})).catch((function(e){t.$message({showClose:!0,message:"图片上传失败",type:"error"}),t.$loading(0)}))},changeFile:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.file_type=e,t.showFile=!1,a.next=4,t.$nextTick();case 4:t.showFile=!0,t.$nextTick((function(){t.$refs.file1.click()}));case 6:case"end":return a.stop()}}),a)})))()},onSubmit:function(){var e=this;this.$refs.spFrom.validate((function(t){if(!t)return console.log(t),e.$message({showClose:!0,message:"内容填写有误",type:"error"}),e.$refs.锚点.scrollIntoView({behavior:"smooth"}),!1;e.sp.id?e.修改():e.add()}))},upload1:function(){var e=this;return new Promise((function(t,a){if(e.coverImgFile.file){var r=new FormData;r.append("file",e.coverImgFile.file),e.$axios.post("/api/upload",r).then((function(a){console.log(a),a.data&&a.data.length>0&&(e.coverImgFile={base64:"",file:""},e.sp.coverImg=a.data[0]),t()})).catch((function(e){t()}))}else t()}))},upload2:function(){var e=this;return new Promise((function(t,a){if(0==e.imgsFiles.length)t();else{var r=new FormData;e.imgsFiles.forEach((function(e){r.append("file",e.file)})),e.$axios.post("/api/upload",r).then((function(a){console.log(a),a.data&&a.data.length>0&&(e.imgsFiles=[],e.sp.imgs=[].concat(Object(n["a"])(e.sp.imgs),Object(n["a"])(a.data))),t()})).catch((function(e){t()}))}}))},add:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$loading(1),Promise.all([e.upload1(),e.upload2()]).then((function(t){e.$axios.post("/api/product",e.sp).then((function(t){console.log(t),0==t.code?(e.$message({showClose:!0,message:"添加成功",type:"success"}),history.back()):e.$message({showClose:!0,message:"添加失败，请联系管理员",type:"error"}),e.$loading()})).catch((function(t){e.$message({showClose:!0,message:"添加失败，请联系管理员",type:"error"}),e.$loading(0)}))}));case 2:case"end":return t.stop()}}),t)})))()},"修改":function(){var e=this;this.$loading(1),Promise.all([this.upload1(),this.upload2()]).then((function(t){delete e.sp.createdAt,delete e.sp.updatedAt,delete e.sp.deletedAt,e.$axios.put("/api/product/".concat(e.sp.id),e.sp).then((function(t){console.log(t),0==t.code?(e.$message({showClose:!0,message:"更新成功",type:"success"}),history.back()):e.$message({showClose:!0,message:"更新失败，请联系管理员",type:"error"}),e.$loading()})).catch((function(t){e.$message({showClose:!0,message:"更新失败，请联系管理员",type:"error"}),e.$loading(0)}))}))},getproduct:function(){var e=this;this.$axios.get("/api/product/".concat(this.sp.id)).then((function(t){0==t.code&&console.log(t.data.seckillPrice),e.sp=t.data})).catch((function(e){}))},change_1:function(e){this.sp[e]=this.sp[e]?Math.ceil(100*this.sp[e])/100:0},"获取商品分类":function(){var e=this;this.$axios.get("/api/category",{params:{page:1,size:1e3}}).then((function(t){0===t.code&&(e.分类=t.data,!e.sp.id&&e.分类.length>0&&(e.sp.categoryId=e.分类[0].id))}))}},mounted:function(){this.sp.id=this.$route.query.id,this.sp.id&&this.getproduct()},watch:{}}),l=c,u=(a("fd6c"),a("2877")),f=Object(u["a"])(l,r,i,!1,null,"f17f895a",null);t["default"]=f.exports},fd6c:function(e,t,a){"use strict";a("10d0")}}]);
//# sourceMappingURL=chunk-6b254ce2.0bde22ed.js.map